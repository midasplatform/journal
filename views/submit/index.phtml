<?php
$this->headScript()->appendFile($this->webroot . '/privateModules/reviewosehra/public/js/lib/File-Upload/jquery.iframe-transport.js');
$this->headScript()->appendFile($this->webroot . '/privateModules/reviewosehra/public/js/lib/File-Upload/jquery.fileupload.js');
$this->headScript()->appendFile($this->webroot . '/privateModules/reviewosehra/public/js/submit/submit.index.js');
?>
<link type="text/css" href="<?php echo $this->webroot ?>/privateModules/reviewosehra/public/css/submit/submit.index.css" rel="stylesheet" />
<link type="text/css" href="<?php echo $this->webroot ?>/privateModules/reviewosehra/public/js/lib/File-Upload/jquery.fileupload-ui.css" rel="stylesheet" />

<h2>Review an article</h2>
<h3>Title: <?php echo $this->resource->getName() ?> </h3>
<div class="abstract" style="text-align: justify;"><?php echo str_replace("<br>", "<br/>", nl2br($this->resource->getDescription())) ?></div>


<h3><?php echo ($this->listArray['list']['type'] == OSERHAREVIEW_LIST_PEERREVIEW) ? "Peer Review": "Final Review"?></h3>
<div class="abstract" style="text-align: justify;">
  <?php if ($this->listArray['list']['type'] == OSERHAREVIEW_LIST_PEERREVIEW):?>
    A peer review is an attestation by a fellow developer or community member that contributed software is useful and of high quality.
    The goal is to ensure that it has a demonstrable and useful function, that it is licensed correctly, that it installs correctly and easily,
    that it is documented, that it is tested and that the tests cover a reasonable portion of the code.
    Please use the topics and questions below as guides as you go through your review.
    In the end, use the OSEHRA Certification Standard Matrix to help you select a "Recommended Certification Level."
    All comments and attachments will be reviewed as part of the certification process and will help guide the final certification level determination.
  <?php else:?>
    A Final Review is a necessary confirmation that all required procedures have been executed and the submission is complete.
    The topics and questions for the Final Review each correspond to one column of the OSEHRA Certification Standard Matrix and is what will determine the Certification level for the submission.
    The OSEHRA Certification Level achieved by the submission is the highest level in the Standard Matrix that <b>all</b> questions have achieved.
    For more details on the criteria for each topic, see the <a href="http://www.osehra.org/sites/default/files/OSEHRA_Certification_Standards_V2.pdf">OSEHRA Certification Standards Document</a>.
  <?php endif;?>
</div>
<div id="certificationWrapper">
  <h4>OSEHRA Certification Standard Matrix:</h4>
  <table id="certificationTable">
    <thead>
    </thead>
    <tbody>
    </tbody>
  </table>
</div>
<br/>
<div id="reviewWrapper">
  <table>
    <tr>
      <td id="tdLeftPanel">
        <div id="divLeftPanel">
          <h4 id="descriptionQuestionList"> </h4>
          <h4>Summary</h4>
          <table id="summaryTable">
            <thead>
              <tr>
                <th>Topic</th>
                <?php if ($this->listArray['list']['type'] == OSERHAREVIEW_LIST_FINALREVIEW):?>
                  <th>Level</th>
                  <th>Comments</th>
                <?php else:?>
                  <th>Completed</th>
                <?php endif;?>
              </tr>
            </thead>
            <tbody>
              
            </tbody>
            <tfoot>
              <tr id="summaryProgress">
                <td colspan="3">
                  <progress value="0" max="100"></progress>
                </td>
              </tr>
            </tfoot>
          </table>
          <h4>Comments</h4>
          <textarea 
            <?php
            if(!$this->isEditable)echo 'readonly';
            ?> 
            id="globalComment"></textarea>
          <h4>Recommended Certification Level
          <select id="certificationLevel"
            <?php
            if(!$this->isEditable)echo 'readonly';
            ?> >
            <option></option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
          </select>
          </h4>
          
          <?php
          if($this->isEditable)echo ' <input id="saveReview" type="button" value="Save"/>';
          ?>
        </div>
      </td>
      <td id="tdRightPanel">
        <div id="divRightPanel">
          <h4>Topics: <select id="listTopics">

          </select></h4>
          <div id="templateQuestion" style="display:none;">
            <div class="selectMultipleWrapper">
              <?php if ($this->listArray['list']['type'] == OSERHAREVIEW_LIST_PEERREVIEW): ?>
                <select <?php   if(!$this->isEditable)echo 'disabled="disabled"';  ?> multiple size=4>
                  <option value="<?php echo OSERHAREVIEW_REVIEW_LOW ?>">Low</option>
                  <option value="<?php echo OSERHAREVIEW_REVIEW_MEDIUM ?>">Medium</option>
                  <option value="<?php echo OSERHAREVIEW_REVIEW_HIGH ?>">High</option>
                  <option value="<?php echo OSERHAREVIEW_REVIEW_NA ?>">N/A</option>
                </select>
              <?php else: ?>
                <select <?php   if(!$this->isEditable)echo 'disabled="disabled"';  ?> multiple size=5>
                  <option value="<?php echo OSEHRAREVIEW_LEVEL_ZERO ?>">Level 0</option>
                  <option value="<?php echo OSEHRAREVIEW_LEVEL_ONE ?>">Level 1</option>
                  <option value="<?php echo OSEHRAREVIEW_LEVEL_TWO ?>">Level 2</option>
                  <option value="<?php echo OSEHRAREVIEW_LEVEL_THREE ?>">Level 3</option>
                  <option value="<?php echo OSEHRAREVIEW_LEVEL_FOUR ?>">Level 4</option>
                </select>
              <?php endif; ?>
            </div>
            <span class="questionDescription">{description}</span><br/>
            <div class="commentWrapper">
              <table>
                <tr>
                  <td style="width:100px;">Comment: </td>
                  <td><textarea <?php   if(!$this->isEditable)echo 'readonly';  ?> ></textarea> </td>
                </tr>     
              </table>
            </div>
            <div class="uploadWrapper">
              <table>
                <tr>
                  <td style="vertical-align: top;width:100px;">Attachment: </td>
                  <td>
                     <label class="downloadButton" class="fileinput-button">
                          <a class="fileNameUploaded"></a>
                      </label>
                    <?php
                      if($this->isEditable)
                        {?>
                        <label class="uploadButton"  class="fileinput-button">
                            <span class="inputUpload" style="color:#56758B;cursor:pointer;">Attach a file...</span>
                            <input class="fileupload"  style='display:none;' type="file" name="files[]">
                        </label>
                        <label class="uploadProgress" style="display:none;">
                            Upload in progress... <span class="progressValue"></span>
                        </label>
                    <?php
                        }?>
                       
                        <input type="hidden" class="fileItemId" value=""/>
                  </td>
                </tr>     
              </table>
            </div>
          </div>
        </div>        
      </td>
    </tr>
  </table>  
</div>
